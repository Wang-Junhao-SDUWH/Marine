C51 COMPILER V9.00   LCD1602                                                               10/15/2019 21:56:19 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE LCD1602
OBJECT MODULE PLACED IN .\Objects\Lcd1602.obj
COMPILER INVOKED BY: E:\Keil_v5\C51\BIN\C51.EXE Lcd1602.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\L
                    -cd1602.lst) TABS(2) OBJECT(.\Objects\Lcd1602.obj)

line level    source

   1          /******************** (C) COPYRIGHT 2015 Silicone shell electronic studio **************************
   2           * ÎÄ¼þÃû  £ºLcd1602.c
   3           * ÃèÊö    : 1602Òº¾§ÏÔÊ¾ÆÁ¿âº¯Êý        
   4           * Ó²¼þÁ¬½Ó£º EN:P2.5
   5           *            RW:P2.6
   6           *            RS:P2.7
   7           *            D0~D7:P0¿Ú
   8           *
   9           * ÊµÑéÆ½Ì¨£ºSHELL1.0¿ª·¢°å
  10           *
  11           * ×÷Õß    £ºSilicone shell electronic studio
  12           * ÌÔ±¦    £ºhttp://shop111698447.taobao.com/shop/view_shop.htm?spm=a1z0e.1.10010.5.GCUiZL
  13          **********************************************************************************/
  14          #include "lcd.h"
  15          #include <intrins.h>
  16          #include <reg52.h>
  17          
  18          /*********************LCD1602¶Ë¿Ú¶¨Òå***************************/
  19          sbit LCD_E        =P3^4;          //Ö´ÐÐÊ¹ÄÜ¶Ë
  20          sbit LCD_RW       =P3^6;          //¶ÁÐ´¿ØÖÆ¶Ë
  21          sbit LCD_RS       =P3^5;          //Êý¾ÝÃüÁîÑ¡Ôñ¶Ë
  22          
  23          /*
  24           * º¯ÊýÃû£ºDelay
  25           * ÃèÊö  £ºÑÓÊ±º¯Êý
  26           *         
  27           * ÊäÈë  £ºunsigned int time£ºÑÓÊ±Á¿
  28           * Êä³ö  £ºÎÞ
  29           * ËµÃ÷  £º
  30           */
  31          void Delay(unsigned int time)
  32          {
  33   1          unsigned int timeCounter = 0;
  34   1        for (timeCounter = time;timeCounter > 0 ;timeCounter --)
  35   1          DelayUs(255);
  36   1      }
  37          /*
  38           * º¯ÊýÃû£ºDelayUs
  39           * ÃèÊö  £ºÑÓÊ±º¯Êý£¨Î¢Ãë£©
  40           *         
  41           * ÊäÈë  £ºunsigned int time£ºÑÓÊ±Á¿
  42           * Êä³ö  £ºÎÞ
  43           * ËµÃ÷  £º
  44           */
  45          void DelayUs(unsigned int time)
  46          {
  47   1        unsigned int timeCounter = 0;
  48   1        for (timeCounter = 0;timeCounter < time;timeCounter ++)
  49   1          _nop_();
  50   1      }
  51          
  52          /****************************************************************************************\
  53          **                   LCDÇý¶¯Ä£¿é                **
  54          \****************************************************************************************/
C51 COMPILER V9.00   LCD1602                                                               10/15/2019 21:56:19 PAGE 2   

  55          
  56          /*
  57           * º¯ÊýÃû£ºLCDInit
  58           * ÃèÊö  £ºÒº¾§³õÊ¼»¯º¯Êý
  59           *         
  60           * ÊäÈë  £ºÎÞ
  61           * Êä³ö  £ºÎÞ
  62           * ËµÃ÷  £º
  63           */
  64          void LCDInit(void)
  65          {
  66   1          //Èý´ÎÏÔÊ¾Ä£Ê½ÉèÖÃ
  67   1        LCD_Data=0;
  68   1        LCD_E=Disable;
  69   1        Delay(5);
  70   1        WriteCmd(LCD_Init);
  71   1        Delay(5);
  72   1        WriteCmd(LCD_Init);
  73   1        Delay(5);
  74   1        WriteCmd(LCD_Init);
  75   1      
  76   1        WriteCmd(LCD_Init);               //³õÊ¼»¯
  77   1        WriteCmd(LCD_CloseCtr);             //¹Ø¹â±êÏÔÊ¾
  78   1        WriteCmd(LCD_CLS);                //ÇåÆÁÄ»
  79   1        WriteCmd(0x05);         //¹â±êÒÆ¶¯ÉèÖÃ       0x07(00000111)Ö¸Õë¡¢¹â±ê×Ô¶¯¼ÓÒ»£¬ÆÁ×óÒÆ£¨·½ÏòÏò×óÐ´ÂúÆÁÄ»ºó£¬¾É
             -ÄÚÈÝÒç³ö£© 
  80   1        WriteCmd(LCD_DispCtr);  //ÏÔÊ¾¿ªÒÔ¼°¹â±êÉèÖÃ 0x06(00000110)Ö¸Õë¡¢¹â±ê×Ô¶¯¼ÓÒ»£¬ÆÁ¹Ì¶¨£¨·½ÏòÏòÓÒÐ´ÂúÆÁÄ»ºóÐ
             -ÂÄÚÈÝÒç³ö£©
  81   1      }                             //               0x05(00000101)Ö¸Õë¡¢¹â±ê×Ô¶¯¼õÒ»£¬ÆÁÓÒÒÆ£¨·½ÏòÏòÓÒÐ´ÂúÆÁÄ»ºó£¬¾ÉÄÚÈÝÒç³ö£©  
  82                                        //               0x04(00000100)Ö¸Õë¡¢¹â±ê×Ô¶¯¼õÒ»£¬ÆÁ¹Ì¶¨£¨·½ÏòÏò×óÐ´ÂúÆÁÄ»ºóÐÂÄÚÈÝÒç³ö£©
  83          /*---------------------------------  LCDÄ£Ê½ÉèÖÃº¯Êý--------------------------------------*\
  84            
  85            SetWriteCmd()         ÉèÖÃLCDÎªÐ´ÃüÁîÄ£Ê½
  86            SetReadCmd()              ÉèÖÃLCDÎª¶ÁÃüÁîÄ£Ê½
  87            SetWriteData()        ÉèÖÃLCDÎªÐ´Êý¾ÝÄ£Ê½
  88            
  89          \*----------------------------------------------------------------------------------------*/
  90          /*
  91           * º¯ÊýÃû£ºSetWriteCmd
  92           * ÃèÊö  £ºÉèÖÃLCDÎªÐ´ÃüÁîÄ£Ê½
  93           *         
  94           * ÊäÈë  £ºÎÞ
  95           * Êä³ö  £ºÎÞ
  96           * ËµÃ÷  £º
  97           */
  98          void SetWriteCmd(void)
  99          {
 100   1        LCD_RW=Write;
 101   1        LCD_RS=Cmd;
 102   1      }
 103          /*
 104           * º¯ÊýÃû£ºSetReadCmd
 105           * ÃèÊö  £ºÉèÖÃLCDÎª¶ÁÃüÁîÄ£Ê½
 106           *         
 107           * ÊäÈë  £ºÎÞ
 108           * Êä³ö  £ºÎÞ
 109           * ËµÃ÷  £º
 110           */
 111          void SetReadCmd(void)
 112          {
 113   1        LCD_RW=Read;
 114   1        LCD_RS=Cmd;
C51 COMPILER V9.00   LCD1602                                                               10/15/2019 21:56:19 PAGE 3   

 115   1      }
 116          /*
 117           * º¯ÊýÃû£ºSetWriteData
 118           * ÃèÊö  £ºÉèÖÃLCDÎªÐ´Êý¾ÝÄ£Ê½
 119           *         
 120           * ÊäÈë  £ºÎÞ
 121           * Êä³ö  £ºÎÞ
 122           * ËµÃ÷  £º
 123           */
 124          void SetWriteData(void)
 125          {
 126   1        LCD_RW=Write;
 127   1        LCD_RS=Data;
 128   1      }
 129          
 130          /*---------------------------------  LCD¹¦ÄÜÖ´ÐÐº¯Êý--------------------------------------*\
 131            
 132            WriteCmd()          Ð´ÃüÁî
 133            WriteData()         Ð´Êý¾Ý
 134            ExecuteCmd()          Ö´ÐÐÃüÁî
 135            SetXY()           ÏÔÊ¾¶¨Î»
 136            DisplaySingleChar()     ÏÔÊ¾µ¥¸ö×Ö·û
 137            DisplayString()       ÏÔÊ¾Ò»´®×Ö·û
 138            IsBusy()            Ã¦±êÖ¾¼ì²â
 139          \*----------------------------------------------------------------------------------------*/
 140          /*
 141           * º¯ÊýÃû£ºWriteCmd
 142           * ÃèÊö  £ºÐ´ÃüÁî
 143           *         
 144           * ÊäÈë  £ºÎÞ
 145           * Êä³ö  £ºÎÞ
 146           * ËµÃ÷  £º
 147           */
 148          void WriteCmd(char cmd)
 149          {
 150   1        while(IsBusy());
 151   1        LCD_Data=cmd; 
 152   1        SetWriteCmd();
 153   1        ExecuteCmd();
 154   1      }
 155          /*
 156           * º¯ÊýÃû£ºWriteData
 157           * ÃèÊö  £ºÐ´Êý¾Ý
 158           *         
 159           * ÊäÈë  £ºÎÞ
 160           * Êä³ö  £ºÎÞ
 161           * ËµÃ÷  £º
 162           */
 163          void WriteData(char ddata)
 164          {
 165   1        while(IsBusy());
 166   1        LCD_Data=ddata;
 167   1        SetWriteData(); 
 168   1        ExecuteCmd();
 169   1      }
 170          /*
 171           * º¯ÊýÃû£ºExecuteCmd
 172           * ÃèÊö  £ºÖ´ÐÐÃüÁî
 173           *         
 174           * ÊäÈë  £ºÎÞ
 175           * Êä³ö  £ºÎÞ
 176           * ËµÃ÷  £º
C51 COMPILER V9.00   LCD1602                                                               10/15/2019 21:56:19 PAGE 4   

 177           */
 178          void ExecuteCmd(void)
 179          {
 180   1        LCD_E=Enable;
 181   1        LCD_E=Disable;
 182   1      }
 183          /*
 184           * º¯ÊýÃû£ºSetXY
 185           * ÃèÊö  £ºÏÔÊ¾¶¨Î»
 186           *         
 187           * ÊäÈë  £ºÎÞ
 188           * Êä³ö  £ºÎÞ
 189           * ËµÃ÷  £º
 190           */
 191          void SetXY(char x,char y)
 192          {
 193   1        if (y)
 194   1          x|=0x40;
 195   1        else
 196   1          x|=0x00;
 197   1        
 198   1        Delay(5);
 199   1        WriteCmd(x);
 200   1      }
 201          /*
 202           * º¯ÊýÃû£ºDisplaySingleChar
 203           * ÃèÊö  £ºÏÔÊ¾µ¥¸ö×Ö·û
 204           *         
 205           * ÊäÈë  £ºÎÞ
 206           * Êä³ö  £ºÎÞ
 207           * ËµÃ÷  £º
 208           */
 209          void DisplaySingleChar(char x,char y,char cchar)
 210          {
 211   1        SetXY(x,y);
 212   1        WriteData(cchar); 
 213   1      }
 214          /*
 215           * º¯ÊýÃû£ºDisplayString
 216           * ÃèÊö  £ºÏÔÊ¾×Ö·û´®
 217           *         
 218           * ÊäÈë  £ºÎÞ
 219           * Êä³ö  £ºÎÞ
 220           * ËµÃ÷  £º
 221           */
 222          //void DisplayString(char x,char y,char *str)
 223          //{
 224          //  while(*str)
 225          //  {
 226          //    Delay(50);
 227          //    DisplaySingleChar(x++,y,*str);
 228          //    str++;
 229          //  }
 230          //}
 231          /*
 232           * º¯ÊýÃû£ºIsBusy
 233           * ÃèÊö  £ºÃ¦±êÖ¾¼ì²â
 234           *         
 235           * ÊäÈë  £ºÎÞ
 236           * Êä³ö  £ºÎÞ
 237           * ËµÃ÷  £º
 238           */
C51 COMPILER V9.00   LCD1602                                                               10/15/2019 21:56:19 PAGE 5   

 239          bit IsBusy(void)
 240          {
 241   1        LCD_Data=0xFF;
 242   1        SetReadCmd();
 243   1        ExecuteCmd();
 244   1      //  return (bit)(P0 & 0x80);  
 245   1          return (bit)(LCD_Data & 0x80);  
 246   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    211    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       6
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
